<!--
  RERO ILS UI
  Copyright (C) 2021 RERO

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, version 3 of the License.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<div class="card-header p-2">
  <!-- MAIN ROW ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  <div class="row">
    <div id="holding-location-{{ holding.metadata.pid }}" class="col-sm-12 col-md-3">
      <a href="#"
        class="collapse-link float-left"
        data-toggle="collapse" aria-expanded="false"
        *ngIf="collapsable"
        (click)="$event.preventDefault(); collapsed = !collapsed">
        <i [ngClass]="{ 'fa-caret-down': !collapsed, 'fa-caret-right': collapsed }"
          [hidden]="holding.metadata.public_items_count === 0"
          class="fa fa-lg" aria-hidden="true">
        </i>
      </a>
      {{ holding.metadata.library.name }}: {{ holding.metadata.location.name }}
    </div>
    <div id="holding-category-name-{{ holding.metadata.pid }}" class="col-sm-12 col-md-2">
      {{ holding.metadata.circulation_category.circulation_information | getTranslatedLabel : language }}
    </div>
    <div class="col-sm-12 col-md-2">
      <span [hidden]="holding.metadata.public_items_count === 0">
        {{ holding.metadata.public_items_count }}
        {{ holding.metadata.public_items_count | i18nPlural: { '=0': 'item', '=1': 'item', 'other': 'items' } | translate }}
      </span>
    </div>
    <div id="holding-available-{{ holding.metadata.pid }}" class="col-sm-12 col-md-3">
      <span [hidden]="!collapsed && collapsable">
        <ng-container *ngIf="holding.metadata.holdings_type === 'serial'; else available">
          <i class="fa fa-circle text-warning"></i>
          {{ 'see collections and items' | translate }}
        </ng-container>
        <ng-template #available>
          <i class="fa fa-circle"
            [ngClass]="{'text-success': holding.metadata.available, 'text-danger': !holding.metadata.available }">
          </i>
          {{ (holding.metadata.available ? 'available' : 'not available') | translate }}
        </ng-template>
      </span>
    </div>
    <!-- request dialog -->
    <div id="holding-request-{{ holding.metadata.pid }}"
        [ngClass]="requestDialog ? 'row col-12' : 'col-sm-12 col-md-2'">
        <public-search-request
        [record]="holding" recordType="holding"
        (requestDialogEvent)="getRequestDialogValue($event)"
        [viewcode]="viewcode" class="w-100"></public-search-request>
    </div>
  </div>
  <!-- SERIAL HOLDING INFORMATIOLNS ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  <dl class="row holdings-data pt-4" *ngIf="holding.metadata.holdings_type === 'serial'">
    <!-- CALL NUMBER -->
    <ng-container *ngIf="holding.metadata.call_number">
      <dt class="col-2 col-sm-4 label-title" translate>Call number</dt>
      <dd id="holding-call-number-{{ holding.metadata.pid }}" class="col-10 col-sm-8">
        {{ holding.metadata.call_number }}
        <ng-container *ngIf="holding.metadata.second_call_number">
        | {{ holding.metadata.second_call_number }}
      </ng-container>
      </dd>
    </ng-container>
    <!-- ENUMERATION AND CHRONOLOGY -->
    <ng-container *ngIf="holding.metadata.enumerationAndChronology">
      <dt class="col-2 col-sm-4 label-title" translate>Available collection</dt>
      <dd id="holding-enum-chro-{{ holding.metadata.pid }}"
          class="col-10 col-sm-8"
          [innerHTML]="holding.metadata.enumerationAndChronology | nl2br">
      </dd>
    </ng-container>
    <!-- SUPPLEMENTARY CONTENT -->
    <ng-container *ngIf="holding.metadata.supplementaryContent">
      <dt class="col-2 col-sm-4 label-title" translate>Supplementary content</dt>
      <dd id="holding-sup-content-{{ holding.metadata.pid }}" class="col-10 col-sm-8">{{ holding.metadata.supplementaryContent }}</dd>
    </ng-container>
    <!-- INDEX -->
    <ng-container *ngIf="holding.metadata.index">
      <dt class="col-2 col-sm-4 label-title" translate>Indexes</dt>
      <dd id="holding-index-{{ holding.metadata.pid }}" class="col-10 col-sm-8">{{ holding.metadata.index }}</dd>
    </ng-container>
    <!-- MISSING ISSUES -->
    <ng-container *ngIf="holding.metadata.missing_issues">
      <dt class="col-2 col-sm-4 label-title" translate>Missing issues</dt>
      <dd id="holding-missing-issues-{{ holding.metadata.pid }}" class="col-10 col-sm-8">{{ holding.metadata.missing_issues }}</dd>
    </ng-container>
    <!-- NOTE -->
    <ng-container *ngIf="holding.metadata.notes">
      <ng-container *ngFor="let note of holding.metadata.notes | notesFilter : noteAuthorizedTypes">
        <dt class="col-sm-4 col-2 label-title">
          <i class="fa fa-sticky-note-o pr-2"></i>
          {{ note.type | translate }}
        </dt>
        <dd class="col-sm-8 col-10" [innerHTML]="note.content | nl2br"></dd>
      </ng-container>
    </ng-container>
  </dl>
</div>
<public-search-items [holding]="holding"
                     [viewcode]="viewcode"
                     [hidden]="collapsed || !collapsable"
></public-search-items>
