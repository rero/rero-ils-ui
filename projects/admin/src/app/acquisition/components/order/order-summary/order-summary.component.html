<!--
  RERO ILS UI
  Copyright (C) 2021-2024 RERO
  Copyright (C) 2021 UCLouvain

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, version 3 of the License.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
@if (order) {
<section class="grid">
  <div class="md:col-8">
    <dl class="metadata">
      <!-- VENDOR -->
      @if (order.vendor) {
      <dt translate>Vendor</dt>
      <dd>
        {{
          order.vendor.pid | getRecord : "vendors" : "field" : "name" | async
        }}
      </dd>
      }
      <!-- ORDER STATUS -->
      <dt translate>Order status</dt>
      <dd>{{ order.status | translate }}</dd>
      <!-- ORDER DATE -->
      @if (order.order_date) {
      <dt translate>Order date</dt>
      <dd>{{ order.order_date | dateTranslate : "shortDate" }}</dd>
      }
      <!-- NOTES (optional) -->
      <ng-content select="[notes]"></ng-content>
    </dl>
  </div>
  <!-- ORDER TOTAL AMOUNT -->
  <div class="md:col-4 flex flex-column gap-2">
    <ng-container
      [ngTemplateOutlet]="totalAmount"
      [ngTemplateOutletContext]="{
        quantity: order.account_statement.provisional.quantity,
        total: order.account_statement.provisional.total_amount,
        label: 'Ordered' | translate
      }"
    />
    @if (order.account_statement.expenditure.quantity > 0) {
    <ng-container
      [ngTemplateOutlet]="totalAmount"
      [ngTemplateOutletContext]="{
        quantity: order.account_statement.expenditure.quantity,
        total: order.account_statement.expenditure.total_amount,
        label: 'Received' | translate
      }"
    />
    }
  </div>
</section>
}
<ng-template
  #totalAmount
  let-quantity="quantity"
  let-total="total"
  let-label="label"
>
  <div
    class="surface-100 py-5 px-8 border-1 border-round surface-border relative"
  >
    <div
      style="border-bottom-left-radius: var(--border-radius)"
      class="absolute text-color-secondary border-left-1 border-bottom-1 surface-border py-2 px-4 top-0 right-0"
    >
      <i class="fa fa-shopping-cart"></i>&nbsp;{{ quantity }}
    </div>
    <div class="text-center">
      <span class="text-xl font-bold">{{
        total | currency : order.currency : "symbol"
      }}</span>
      <label class="text-sm text-color-secondary">{{ label }}</label>
    </div>
  </div>
</ng-template>
