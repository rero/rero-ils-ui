<!--
  RERO ILS UI
  Copyright (C) 2021-2025 RERO

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, version 3 of the License.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
@if(!store.isDocumentHarvested()) {
  <admin-menu-actions [document]="store.document()" />
}

@if(store.filter().length > 1) {
  <div class="ui:my-3">
    <p-multiselect
      [options]="store.filter()"
      optionLabel="name"
      optionValue="pid"
      [fluid]="true"
      [maxSelectedLabels]="2"
      [placeholder]="'Filter by library'|translate"
      (onChange)="store.setLibraryFilter($event)"
    />
  </div>
}

@if (store.holdingsCurrentOrganisation().length > 0) {
  <div class="ui:my-2">
    <p-accordion [multiple]="true" [value]="store.holdingsCurrentOrganisation().length === 1 ? 0 : null">
      @for(record of store.holdingsCurrentOrganisation(); track record.metadata.pid; let i = $index) {
        <p-accordion-panel [value]="i" class="ui:mb-2">
          <p-accordion-header>
            <admin-holding-header class="ui:w-full" [holding]="record" [isCurrentOrganisation]="true" (deleteHolding)="store.delete(record)" />
          </p-accordion-header>
          <p-accordion-content #content>
            @if (content.active()) {
              <admin-holding-content [holding]="record" [isCurrentOrganisation]="true" />
            }
          </p-accordion-content>
        </p-accordion-panel>
      }
    </p-accordion>
  </div>
}

@if (store.holdingsOtherOrganisation().length > 0) {
  <div class="ui:mt-4">
    <h5 translate>Other organisations</h5>
    <p-accordion [multiple]="true">
      @for(record of store.holdingsOtherOrganisation(); track record.metadata.pid; let i = $index) {
        <p-accordion-panel [value]="i" class="ui:mb-2">
          <p-accordion-header>
            <admin-holding-header class="ui:w-full" [holding]="record" [isCurrentOrganisation]="false" />
          </p-accordion-header>
          <p-accordion-content #content>
            @if (content.active()) {
              <admin-holding-content [holding]="record" [isCurrentOrganisation]="false" />
            }
          </p-accordion-content>
        </p-accordion-panel>
      }
    </p-accordion>
  </div>
}
