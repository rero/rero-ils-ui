<!--
  RERO ILS UI
   Copyright (C) 2019 RERO
  
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU Affero General Public License as published by
   the Free Software Foundation, version 3 of the License.
  
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
   GNU Affero General Public License for more details.
  
   You should have received a copy of the GNU Affero General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<div *ngIf="checkedOutItems && checkedOutItems.length === 0 && patron">
  <span translate>No loan for the current patron.</span>
</div>
<div *ngIf="(checkedOutItems && checkedOutItems.length > 0) || (checkedInItems && checkedInItems.length > 0)">
  <!-- HEADER -->
  <div class="row mb-1 align-items-center">
    <div class="col mr-1 d-none d-lg-block">
      <div class="row p-2 bg-dark rounded text-light">
        <div class="col-lg-3" translate>Item</div>
        <div class="col-lg-6" translate>Document</div>
        <div class="col-lg-3" translate>Circulation info</div>
      </div>
    </div>
    <!-- RENEW ALL -->
    <div *ngIf="patron" class="col-sm-2 pl-0">
      <div class="text-left">
        <button class="btn btn-primary d-none d-lg-block"
        (click)="extendAllLoansClick()"
        [disabled]="loansToExtend.length < 1"
        translate>Renew all</button>
      </div>
    </div>
  </div>
  <!-- CHECKED OUT ITEMS -->
  <div class="row align-items-start" *ngFor="let item of checkedOutItems">
    <!-- CONTENT -->
    <div class="col mr-1">
      <admin-item [patron]="patron" [item]="item">
      </admin-item>
    </div>
    <div *ngIf="patron" class="col-md-2 text-left pl-0 mb-2">
      <!-- EXTEND LOAN -->
      <button id="button-basic" class="btn btn-secondary btn-sm mr-1 d-md-block" type="button"
      [disabled]="!item.actions.includes(extendLoan)" (click)="extendLoanClick($event, item)" translate>
      extend_loan
      </button>
      <!-- ACTION DONE -->
        <ng-container *ngIf="item.actionDone" [ngSwitch]="item.actionDone">
          <ng-container *ngSwitchCase="checkin">
            <i class="fa fa-arrow-circle-o-down text-success align-baseline" aria-hidden="true"></i>
            <span class="align-baseline ml-1">{{ item.actionDone | translate }}</span>
          </ng-container>
          <ng-container *ngSwitchCase="checkout">
            <i class="fa fa-arrow-circle-o-right text-success align-baseline" aria-hidden="true"></i>
            <span class="align-baseline ml-1">{{ item.actionDone | translate }}</span>
          </ng-container>
          <ng-container *ngSwitchCase="extendLoan">
            <i class="fa fa-refresh text-success align-baseline" aria-hidden="true"></i>
            <span class="align-baseline ml-1" translate>renew</span>
          </ng-container>
          <ng-container *ngSwitchDefault>
            <span class="align-baseline">{{ item.actionDone | translate }}</span>
          </ng-container>
        </ng-container>
    </div>
  </div>
  <!-- CHECKED IN ITEMS  : RED BORDER FOR TRANSIT, REQUEST OR FEE | GREYED BY DEFAULT-->
  <div class="row align-items-start" *ngFor="let item of checkedInItems">
    <div class="col">
      <admin-item [patron]="patron" [item]="item" (hasFeesEmitter)="hasFees($event)">
      </admin-item>
    </div>
    <div *ngIf="patron" class="col-md-2">
      <!-- ACTION DONE -->
      <div *ngIf="item.actionDone">
        <div [ngSwitch]="item.actionDone">
          <div *ngSwitchCase="'checkin'"><i class="fa fa-arrow-circle-o-down text-success align-middle"
              aria-hidden="true"></i><span class="align-middle ml-1">{{ item.actionDone | translate }}</span>
          </div>
          <div *ngSwitchCase="'checkout'"><i class="fa fa-arrow-circle-o-righttext-success align-middle"
              aria-hidden="true"></i><span class="align-middle ml-1">{{ item.actionDone | translate }}</span>
          </div>
          <div *ngSwitchCase="'extend_loan'"><i class="fa fa-refresh text-success align-middle"
              aria-hidden="true"></i><span class="align-middle ml-1" translate>renew</span></div>
          <div *ngSwitchDefault><span class="align-middle">{{ item.actionDone | translate }}</span></div>
        </div>
      </div>
    </div>
  </div>
</div>
